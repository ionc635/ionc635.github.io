---
layout: single
title: TIL DAY 93
---

# Docker

## 컨테이너

### **컨테이너 방식 장점**

1. 의존성 충돌 문제를 해결해 준다.
2. 개발과 배포 환경을 일치시킨다.
3. 수평 확장을 쉽게 해준다.
4. 각 서버에 새로운 내용을 배포하기 쉽게 만들어준다.

**의존성 충돌 문제 해결**

컨테이너 기술을 바탕으로 한 컴퓨터 안에 여러 대의 컨테이너가 존재하고, 이를 통해 애플리케이션 실행 환경이 격리된다. 컨테이너는 무엇을 격리하고, 어떤 자원들을 독립적으로 소유할까?

1. 프로세스
    - 특정 컨테이너에서 작동하는 프로세스는 기본적으로 그 컨테이너 안에서만 액세스할 수 있다.
    - 컨테이너 안에서 실행되는 프로세스는 다른 컨테이너의 프로세스에게 영향을 줄 수 있다.
2. 네트워크
    - 기본으로 컨테이너 하나에 하나의 IP 주소가 할당되어 있다.
3. 파일 시스템
    - 컨테이너 안에서 사용되는 파일 시스템은 구획화되어 있다. 그래서 해당 컨테이너에서의 명령이나 파일 등의 액세스를 제한할 수 있다.

**개발과 배포 환경 일치**

OS에 상관없이 즉시 애플리케이션 실행 환경을 만들 수 있다. 개발을 컨테이너 위에서 진행할 경우, 모든 개발팀이 동일한 환경 하에 개발을 진행할 수 있다.

**수평 확장 용이**

각 서버에 새로운 내용을 배포하기 쉽게 만들어준다. 컨테이너 기술의 가장 큰 장점은 **실행 환경의 일치이**다. 더 많은 트래픽으로 인한 서버 증설에 컨테이너 기술은 아주 활발하게 이용되고 있다. 동일한 애플리케이션 구성(이미지)을 바탕으로 새로운 서버에 해당 애플리케이션을 컨테이너로 실행하고, 로드 밸런서에 이 서버를 추가하기만 하면 된다.

## Docker 용어

### **컨테이너**

애플리케이션이 의존성, 네트워크 환경, 파일 시스템에 구애받지 않고, 도커라는 기술 위에 실행될 수 있도록 만든 애플리케이션 상자이다.

### **이미지**

실행되는 모든 컨테이너는 이미지로부터 생성된다. 이미지는 애플리케이션 및 애플리케이션 구성을 함께 담아놓은 템플릿으로, 이를 이용해 즉시 컨테이너를 만들 수 있다.

이미지를 이용해 여러 개의 컨테이너를 생성할 수 있다. 이를 이용해 앞서 설명한 애플리케이션의 수평 확장이 가능하다.

이미지는 기본 이미지(base image)로부터 (마치 git을 사용하는 것처럼) 변경 사항을 추가/커밋해서 또 다른 이미지를 만들 수도 있다. 예를 들어 node.js로 작성된 애플리케이션을 이미지로 만들고 싶은 경우, nodejs 이미지를 기본 이미지로 삼고 내가 만든 애플리케이션을 추가해 넣고, 이미지화할 수 있다.

### **레지스트리**

이미지는 레지스트리에 저장된다. 대표적인 이미지 레지스트리로는 Docker Hub, Amazon ECR이 있다. 도커 CLI에서 이미지를 이용해 컨테이너를 생성할 때, 호스트 컴퓨터에 이미지가 존재하지 않는다면, 기본 레지스트리로부터 다운로드 받게 된다.

## Sprint Review

- 컨테이너 기술에서 이미지는 템플릿, 컨테이너는 템플릿으로 구성된 독립적인 컴퓨팅 유닛이다. AWS의 AMI와 인스턴스, 객체 지향에서 클래스와 인스턴스의 관계와 비슷하다.
- 도커를 VM과 비교해 보면 컴퓨팅 자원 (CPU, RAM 등)을 공유, 격리성 제공, OS의 커널(코어 프로그램)을 공유한다는 특징을 가지고 있따.
- 컨테이너의 공유와 격리
  
    격리: 프로세스, 네트워크, 파일시스템
    
    - 프로세스 - node 16, node 17
    - 네트워크 - 컨테이너마다 IP 주소가 있다.
    - 파일 시스템 - /usr /dev /opt /home
    
    공유: CPU, 메모리와 같은 컴퓨팅 파워, 리눅스 커털
    
- 도커는 어떻게 운영체제를 포함시키지 않고 개발과 배포환경을 일치시킬 수 있을까? 도커는 리눅스 컨테이너 기술(lxc)을 기반으로 운영되고 있다. 운영체제가 컨테이너 기술을 지원한다. 도커 위에 개발환경을 구축한다.
- 개발과 배포환경의 일치를 위해 배포환경은 리눅스 커널을 소유하고 있는 운영체제 위에 작동 → 도커 설치 필요
- 커널: 운영체제의 근간이 되는 프로그램 ⇒ 시스템 콜 ⇒ CPU, RAM, 주변기기 등의 하드웨어적인 접근, 파일 쓰기 등을 할 수 있게 만든다.
- AWS EC2 안에 도커를 사용하면 가상화 VM 안에 컨테이너를 담아둔 개념이다.
- VM = 운영체제 + 애플리케이션 단위 추상화, 도커 = 애플리케이션 단위 추상화 ⇒ 리눅스 커널 공유
- httpd 웹 서버 = 정적 웹사이트 호스팅 하는 용도로 만들어진 프로그램 - 클라이언트에 적합